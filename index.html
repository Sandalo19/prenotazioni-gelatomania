<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Prenotazioni – Ristorante Bar Gelatomania</title>
<style>
  :root{--bg:#fafafa;--card:#fff;--accent:#A43F3F;--muted:#666;--success:#2e8b57}
  *{box-sizing:border-box} body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);margin:0;color:#111}
  header{background:linear-gradient(90deg, rgba(164,63,63,0.95), rgba(130,40,40,0.95));color:white;padding:18px}
  .container{max-width:980px;margin:20px auto;padding:16px}
  .card{background:var(--card);border-radius:10px;padding:16px;box-shadow:0 6px 22px rgba(0,0,0,0.06)}
  label{display:block;margin-bottom:6px;color:var(--muted)}
  input,select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #e6e6e6;margin-bottom:8px}
  .row{display:flex;gap:8px}
  .row > div{flex:1}
  .btn{padding:10px 14px;border-radius:8px;background:var(--accent);color:white;border:0;cursor:pointer}
  .btn.ghost{background:transparent;color:var(--accent);border:1px solid var(--accent)}
  .small{font-size:.9rem;color:var(--muted)}
  #message{margin-top:8px}
</style>
</head>
<body>
<header>
  <div style="max-width:980px;margin:0 auto;display:flex;justify-content:space-between;align-items:center">
    <h1>Ristorante Bar Gelatomania — Prenota</h1>
    <div class="small">Orario prenotazioni: 12:00 – 14:30</div>
  </div>
</header>

<main class="container">
  <section class="card">
    <h2>Nuova prenotazione</h2>
    <form id="bookingForm" autocomplete="off">
      <label>Nome e Cognome *</label>
      <input id="name" type="text" required placeholder="Mario Rossi">

      <label>Telefono *</label>
      <input id="phone" type="tel" required placeholder="333 1234567">

      <div class="row">
        <div>
          <label>Data *</label>
          <input id="date" type="date" required>
        </div>
        <div>
          <label>Ora * (12:00 - 14:30)</label>
          <input id="time" type="time" required min="12:00" max="14:30" step="900">
        </div>
      </div>

      <label>Area *</label>
      <select id="area" required>
        <option value="">Scegli...</option>
        <option value="inside">Dentro</option>
        <option value="outside">Fuori</option>
      </select>

      <div class="row">
        <div>
          <label>Adulti *</label>
          <input id="adults" type="number" min="1" max="50" value="2" required>
        </div>
        <div>
          <label>Bambini</label>
          <input id="children" type="number" min="0" max="50" value="0">
        </div>
      </div>

      <label>Note</label>
      <textarea id="notes" rows="3" placeholder="Allergie, seggiolone, ecc."></textarea>

      <div style="display:flex;gap:8px">
        <button class="btn" type="submit">Prenota</button>
        <button id="clearForm" type="button" class="btn ghost">Pulisci</button>
      </div>

      <div id="message" class="small"></div>
    </form>
  </section>
</main>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<script>
  // ======= INSERISCI QUI LA TUA FIREBASE CONFIG (sostituisci i valori) =======
const firebaseConfig = {
    apiKey: "AIzaSyDhkuWdU6n2kvitoaHyK0jlyYrPLR_2wQ4",
    authDomain: "gelatomania-prenotazioni.firebaseapp.com",
    projectId: "gelatomania-prenotazioni",
    storageBucket: "gelatomania-prenotazioni.firebasestorage.app",
    messagingSenderId: "1077584417614",
    appId: "1:1077584417614:web:2dbf35b1f1c647c5ff041f",
    measurementId: "G-N283TL911D"
  };
  
  // ========================================================================

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // DOM
  const form = document.getElementById('bookingForm');
  const msg = document.getElementById('message');
  const dateInput = document.getElementById('date');
  dateInput.min = new Date().toISOString().split('T')[0];

  function showMessage(t, err=false){ msg.textContent = t; msg.style.color = err ? '#b00020' : 'green'; setTimeout(()=>msg.textContent='',5000); }

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const date = document.getElementById('date').value;
    const time = document.getElementById('time').value;
    const area = document.getElementById('area').value;
    const adults = Number(document.getElementById('adults').value) || 0;
    const children = Number(document.getElementById('children').value) || 0;
    const notes = document.getElementById('notes').value.trim();

    if(!name || !phone || !date || !time || !area){ showMessage('Compila tutti i campi obbligatori (*)', true); return; }
    if(time < '12:00' || time > '14:30'){ showMessage('Orario consentito: 12:00 - 14:30', true); return; }

    // check data/ora futura
    const dt = new Date(date + 'T' + time);
    if(dt < new Date()){ showMessage('Seleziona data/ora futura.', true); return; }

    try {
      await db.collection('bookings').add({
        name, phone, date, time, area, adults, children, notes,
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      });
      form.reset();
      dateInput.min = new Date().toISOString().split('T')[0];
      showMessage('Prenotazione inviata — grazie!');
    } catch(err){
      console.error(err);
      showMessage('Errore invio prenotazione', true);
    }
  });

  document.getElementById('clearForm').addEventListener('click', ()=>form.reset());
</script>
</body>
</html>


