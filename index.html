<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ristorante Bar Gelatomania - Prenotazioni</title>
<style>
:root{--bg:#fafafa;--card:#fff;--accent:#A43F3F;--muted:#666}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);margin:0;color:#111}
.container{max-width:600px;margin:20px auto;padding:16px}
.card{background:var(--card);border-radius:10px;padding:16px;box-shadow:0 6px 22px rgba(0,0,0,0.06)}
input, select{padding:8px;border-radius:6px;border:1px solid #e6e6e6;width:100%;margin-bottom:12px}
textarea{width:100%;padding:8px;border-radius:6px;border:1px solid #e6e6e6;margin-bottom:12px}
button{padding:8px 12px;border-radius:8px;background:var(--accent);color:white;border:0;cursor:pointer;width:100%}
h2,h3{margin-top:0}
.small{font-size:.9rem;color:var(--muted)}
.success{color:green;margin-top:12px}
.error{color:#b00020;margin-top:12px}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <h2>Ristorante Bar Gelatomania</h2>
    <h3>Prenota il tuo tavolo</h3>
    <label>Nome</label>
    <input id="name" type="text" placeholder="Il tuo nome" required>
    <label>Telefono</label>
    <input id="phone" type="tel" placeholder="Numero di telefono" required>
    <label>Numero adulti</label>
    <input id="adults" type="number" min="1" value="1" required>
    <label>Numero bambini</label>
    <input id="children" type="number" min="0" value="0">
    <label>Area del tavolo</label>
    <select id="area">
      <option value="inside">Dentro</option>
      <option value="outside">Fuori</option>
    </select>
    <label>Data</label>
    <input id="date" type="date" required>
    <label>Orario</label>
    <input id="time" type="time" min="12:00" max="14:30" required>
    <label>Note</label>
    <textarea id="notes" placeholder="Eventuali note"></textarea>
    <button id="bookBtn">Prenota</button>
    <div id="msg" class="small"></div>
  </div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDhkuWdU6n2kvitoaHyK0jlyYrPLR_2wQ4",
    authDomain: "gelatomania-prenotazioni.firebaseapp.com",
    projectId: "gelatomania-prenotazioni",
    storageBucket: "gelatomania-prenotazioni.firebasestorage.app",
    messagingSenderId: "1077584417614",
    appId: "1:1077584417614:web:2dbf35b1f1c647c5ff041f",
    measurementId: "G-N283TL911D"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const bookBtn = document.getElementById('bookBtn');
  const msgEl = document.getElementById('msg');

  function showMsg(t, err=false){
    msgEl.textContent = t;
    msgEl.className = err ? 'error' : 'success';
    setTimeout(()=>{ msgEl.textContent=''; msgEl.className='small'; }, 4000);
  }

  bookBtn.addEventListener('click', async ()=>{
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const adults = parseInt(document.getElementById('adults').value);
    const children = parseInt(document.getElementById('children').value) || 0;
    const area = document.getElementById('area').value;
    const date = document.getElementById('date').value;
    const time = document.getElementById('time').value;
    const notes = document.getElementById('notes').value.trim();

    if(!name || !phone || !date || !time || !adults){
      showMsg('Compila tutti i campi obbligatori', true);
      return;
    }

    try {
      await db.collection('bookings').add({
        name, phone, adults, children, area, date, time, notes,
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      });
      showMsg('Prenotazione avvenuta con successo!');
      document.getElementById('name').value='';
      document.getElementById('phone').value='';
      document.getElementById('adults').value=1;
      document.getElementById('children').value=0;
      document.getElementById('notes').value='';
    } catch(err){
      console.error(err);
      showMsg('Errore durante la prenotazione', true);
    }
  });
</script>
</body>
</html>
